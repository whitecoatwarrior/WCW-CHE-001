<meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WHITE COAT WARRIORS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* All CSS styles remain the same as in the original file */
        :root {
            --primary-blue: #1a56db;
            --secondary-blue: #0ea5e9;
            --dark-blue: #1e3a8a;
            --light-blue: #dbeafe;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-teal: #14b8a6;
            --accent-yellow: #fbbf24;
            --accent-amber: #f59e0b;
            --vibrant-blue: #3b82f6;
            --vibrant-green: #22c55e;
            --vibrant-purple: #a855f7;
            --vibrant-pink: #e879f9;
            --gradient-blue: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            --gradient-green: linear-gradient(135deg, var(--accent-green), #34d399);
            --gradient-orange: linear-gradient(135deg, var(--accent-orange), #f97316);
            --gradient-red: linear-gradient(135deg, var(--accent-red), #f87171);
            --gradient-purple: linear-gradient(135deg, var(--accent-purple), #a78bfa);
            --gradient-pink: linear-gradient(135deg, var(--accent-pink), #f472b6);
            --gradient-teal: linear-gradient(135deg, var(--accent-teal), #2dd4bf);
            --gradient-yellow: linear-gradient(135deg, var(--accent-yellow), #f59e0b);
            --gradient-vibrant: linear-gradient(135deg, #4f46e5, #7c3aed, #ec4899);
            --shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 2px 5px rgba(0, 0, 0, 0.08);
            --shadow-xl: 0 5px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 6px;
            color: #1e3a8a;
            font-size: 8.25px;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .logo {
            text-align: center;
            margin-bottom: 9px;
        }

        .logo h1 {
            font-size: 1.05rem;
            font-weight: 800;
            color: var(--dark-blue);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.08);
            margin-bottom: 1.5px;
            background: var(--gradient-vibrant);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo p {
            color: var(--primary-blue);
            font-weight: 600;
            font-size: 0.525rem;
        }

        .page {
            background: white;
            border-radius: 9px;
            padding: 9px;
            box-shadow: var(--shadow-xl);
            width: 100%;
            display: none;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: linear-gradient(to bottom right, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
            backdrop-filter: blur(10px);
        }

        .active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .promo-banner {
            background: var(--gradient-vibrant);
            color: white;
            padding: 11.25px;
            border-radius: 7.5px;
            margin-bottom: 11.25px;
            text-align: center;
            font-size: 0.45rem;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .promo-banner::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
            z-index: 1;
        }

        .promo-banner h2 {
            font-size: 0.675rem;
            margin-bottom: 6px;
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            position: relative;
            z-index: 2;
        }

        .promo-banner p {
            line-height: 1.4;
            text-align: justify;
            position: relative;
            z-index: 2;
        }

        .form-group {
            margin-bottom: 6px;
        }

        .form-label {
            display: block;
            margin-bottom: 1.5px;
            font-weight: 600;
            color: var(--dark-blue);
            font-size: 0.525rem;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 4.5px 6.75px;
            border: 1.5px solid var(--light-blue);
            border-radius: 3.75px;
            font-size: 0.525rem;
            background: #f8fafc;
            transition: all 0.2s;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(26, 86, 219, 0.15);
        }

        .input-container {
            position: relative;
        }

        .password-container .form-input {
            padding-right: 22.5px;
        }

        .input-icon {
            position: absolute;
            right: 7.5px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-blue);
            font-size: 0.525rem;
            cursor: pointer;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 4.5px 7.5px;
            border: none;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.525rem;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            gap: 3px;
            width: 100%;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-blue);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(26, 86, 219, 0.2);
        }

        .btn-contact {
            background: var(--gradient-green);
            color: white;
        }

        .btn-contact:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25d366, #128c7e);
            color: white;
        }

        .btn-whatsapp:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(37, 211, 102, 0.2);
        }

        .btn-purple {
            background: var(--gradient-purple);
            color: white;
        }

        .btn-purple:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(139, 92, 246, 0.2);
        }

        .btn-red {
            background: var(--gradient-red);
            color: white;
        }

        .btn-red:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(239, 68, 68, 0.2);
        }

        .btn-orange {
            background: var(--gradient-orange);
            color: white;
        }

        .btn-orange:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }

        .error-box {
            background: #fee2e2;
            color: var(--accent-red);
            padding: 3.75px 5.25px;
            border-radius: 2.25px;
            margin-top: 4.5px;
            display: none;
            font-weight: 600;
            font-size: 0.525rem;
            border-left: 2.25px solid var(--accent-red);
        }

        .success-box {
            background: #d1fae5;
            color: var(--accent-green);
            padding: 3.75px 5.25px;
            border-radius: 2.25px;
            margin-top: 4.5px;
            display: none;
            font-weight: 600;
            font-size: 0.525rem;
            border-left: 2.25px solid var(--accent-green);
        }

        .notification-box {
            background: #fef3c7;
            color: #d97706;
            padding: 7.5px;
            border-radius: 4.5px;
            margin-top: 7.5px;
            font-weight: 600;
            font-size: 0.525rem;
            text-align: center;
            border-left: 3px solid #f59e0b;
        }

        .quiz-notification {
            position: fixed;
            top: 15px;
            right: 15px;
            background: white;
            padding: 11.25px;
            border-radius: 7.5px;
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            display: none;
            max-width: 225px;
            border-left: 3.75px solid var(--accent-green);
            animation: slideInRight 0.3s ease;
            transform: translateX(100%);
        }

        .quiz-notification.show {
            display: block;
            transform: translateX(0);
        }

        .quiz-notification.warning {
            border-left-color: var(--accent-orange);
        }

        .quiz-notification.error {
            border-left-color: var(--accent-red);
        }

        .quiz-notification-content {
            display: flex;
            flex-direction: column;
            gap: 7.5px;
        }

        .quiz-notification-title {
            font-weight: 700;
            font-size: 0.6rem;
            color: var(--dark-blue);
        }

        .quiz-notification-message {
            font-size: 0.525rem;
            color: #4b5563;
        }

        .quiz-notification-actions {
            display: flex;
            gap: 6px;
            justify-content: flex-end;
        }

        .quiz-notification-btn {
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 0.4875rem;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .quiz-notification-btn.primary {
            background: var(--gradient-blue);
            color: white;
        }

        .quiz-notification-btn.secondary {
            background: #f3f4f6;
            color: #4b5563;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        .main-page-buttons {
            display: grid;
            gap: 6px;
            margin-top: 9px;
        }

        .quiz-access-section {
            display: none;
            flex-direction: column;
            gap: 6px;
            margin-top: 9px;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 6px;
            padding-bottom: 4.5px;
            border-bottom: 1.5px solid var(--light-blue);
        }

        .quiz-title-container {
            display: flex;
            flex-direction: column;
            gap: 2.25px;
            width: 80%;
        }

        .quiz-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            font-size: 0.525rem;
            color: var(--dark-blue);
            font-weight: 600;
        }

        .timer-container {
            display: flex;
            gap: 4.5px;
            justify-content: flex-end;
            width: 100%;
        }

        .timer, .question-timer {
            background: var(--gradient-blue);
            color: white;
            padding: 2.25px 4.5px;
            border-radius: 7.5px;
            font-weight: 700;
            font-size: 0.525rem;
            box-shadow: var(--shadow);
            white-space: nowrap;
        }

        .timer.total-timer {
            background: var(--gradient-orange);
        }

        .progress-container {
            width: 100%;
            height: 4.5px;
            background: #e5e7eb;
            border-radius: 2.25px;
            overflow: hidden;
            margin-bottom: 6px;
            box-shadow: var(--shadow);
        }

        .progress-bar {
            height: 100%;
            border-radius: 2.25px;
            transition: width 0.4s ease;
            background: var(--gradient-vibrant);
        }

        .question-nav {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(10.5px, 1fr));
            gap: 2.25px;
            margin-bottom: 6px;
        }

        .question-nav-item {
            width: 10.5px;
            height: 10.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 2.25px;
            font-weight: 700;
            font-size: 0.375rem;
            cursor: pointer;
            background: white;
            border: 1.5px solid var(--light-blue);
            transition: all 0.2s;
        }

        .question-nav-item.current {
            background: var(--gradient-vibrant);
            color: white;
            border-color: var(--primary-blue);
            transform: scale(1.1);
        }

        .question-nav-item.solved {
            background: var(--gradient-green);
            color: white;
            border-color: var(--accent-green);
        }

        .question-nav-item.visited {
            background: var(--gradient-orange);
            color: white;
            border-color: var(--accent-orange);
        }

        .question-container {
            margin-bottom: 6px;
        }

        .question-text {
            font-size: 0.5625rem;
            font-weight: 700;
            margin-bottom: 4.5px;
            color: var(--dark-blue);
        }

        .options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 3px;
            margin-bottom: 6px;
        }

        .option {
            padding: 3.75px 6px;
            border: 1.5px solid var(--light-blue);
            border-radius: 3.75px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            background: #f8fafc;
            font-size: 0.525rem;
            position: relative;
        }

        .option:hover {
            border-color: var(--primary-blue);
            background: #e0f2fe;
            transform: translateY(-1px);
        }

        .option.selected {
            border-color: var(--primary-blue);
            background: #dbeafe;
        }

        .option.correct {
            border-color: var(--accent-green);
            background: #d1fae5;
        }

        .option.incorrect {
            border-color: var(--accent-red);
            background: #fee2e2;
        }

        .option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .reasoning {
            background: #f8fafc;
            border-radius: 3.75px;
            padding: 6px;
            margin-top: 6px;
            display: none;
            border-left: 2.25px solid var(--primary-blue);
            font-size: 0.525rem;
        }

        .reasoning-title {
            font-weight: 700;
            margin-bottom: 3px;
            color: var(--dark-blue);
            font-size: 0.5625rem;
        }

        .navigation-buttons {
            display: flex;
            flex-direction: column;
            gap: 3px;
            margin-top: 9px;
        }

        .nav-btn {
            padding: 3.75px 5.25px;
            border-radius: 3.75px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            font-size: 0.525rem;
            display: flex;
            align-items: center;
            gap: 2.25px;
            justify-content: center;
            width: 100%;
        }

        .btn-back {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
        }

        .btn-next {
            background: linear-gradient(135deg, #1d4ed8, #3b82f6);
            color: white;
        }

        .btn-reasoning {
            background: var(--gradient-purple);
            color: white;
        }

        .btn-reasoning.disabled {
            background: #dc3545;
            color: white;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .btn-reasoning.disabled:hover {
            background: #dc3545;
            transform: none;
            box-shadow: none;
        }

        .btn-submit {
            background: var(--gradient-green);
            color: white;
        }

        .results-header-buttons {
            display: flex;
            flex-direction: column;
            gap: 3.75px;
            margin-bottom: 9px;
        }

        .results-header-buttons .btn {
            padding: 3px 4.5px;
            font-size: 0.4875rem;
            width: 100%;
        }

        .result-card {
            background: linear-gradient(135deg, #f8fafc, #e0f2fe);
            border-radius: 6px;
            padding: 9px;
            text-align: center;
            margin-bottom: 9px;
            box-shadow: var(--shadow);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        .result-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-vibrant);
        }

        .result-card h2 {
            font-size: 0.675rem;
            margin-bottom: 6px;
            color: var(--dark-blue);
        }

        .result-card table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.525rem;
            margin-top: 6px;
            box-shadow: var(--shadow);
        }

        .result-card th, .result-card td {
            padding: 3.75px;
            border: 1px solid #dbeafe;
            text-align: left;
        }

        .result-card th {
            background-color: var(--light-blue);
            font-weight: 600;
        }

        .result-card td {
            background-color: #f8fafc;
        }

        .result-actions {
            display: flex;
            flex-direction: column;
            gap: 4.5px;
            margin-top: 9px;
        }

        .all-mcqs-list {
            display: flex;
            flex-direction: column;
            gap: 11.25px;
        }

        .all-mcq-item {
            padding: 7.5px;
            border: 1px solid var(--light-blue);
            border-radius: 6px;
            background: #f8fafc;
            position: relative;
        }

        .all-mcq-item .question-text {
            color: var(--dark-blue);
            font-size: 0.6rem;
            font-weight: 700;
        }

        .all-mcq-options {
            display: flex;
            flex-direction: column;
            gap: 3px;
            margin-top: 4.5px;
        }

        .all-mcq-option {
            font-size: 0.525rem;
            padding: 3px 4.5px;
            border-radius: 3px;
            border: 1px solid #e5e7eb;
        }

        .all-mcq-option.correct {
            background: #d1fae5;
            color: var(--accent-green);
            font-weight: 600;
            border-color: #a7f3d0;
        }

        .all-mcq-reasoning {
            margin-top: 6px;
            font-size: 0.525rem;
            color: #4b5563;
            padding: 6px;
            background: #f8fafc;
            border-radius: 3px;
            border-left: 2.25px solid var(--primary-blue);
        }

        .all-mcq-reasoning strong {
            color: var(--dark-blue);
        }

        .quick-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 9px;
            gap: 6px;
        }

        .stat-card {
            flex: 1;
            background: white;
            border-radius: 4.5px;
            padding: 6px;
            text-align: center;
            box-shadow: var(--shadow);
            border-top: 2px solid var(--primary-blue);
        }

        .stat-card.correct {
            border-top-color: var(--accent-green);
        }

        .stat-card.incorrect {
            border-top-color: var(--accent-red);
        }

        .stat-card.unanswered {
            border-top-color: var(--accent-orange);
        }

        .stat-value {
            font-size: 0.9rem;
            font-weight: 800;
            margin-bottom: 1.5px;
        }

        .stat-label {
            font-size: 0.4875rem;
            font-weight: 600;
            color: #6b7280;
        }

        .performance-meter {
            width: 100%;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            margin: 6px 0;
        }

        .performance-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.4s ease;
            background: var(--gradient-vibrant);
        }

        @media (max-width: 768px) {
            .quiz-header {
                flex-direction: column;
                gap: 4.5px;
                align-items: flex-start;
            }
            
            .navigation-buttons {
                grid-template-columns: 1fr;
            }
            
            .timer-container {
                position: relative;
                top: auto;
                right: auto;
                margin-top: 3.75px;
                justify-content: flex-end;
                width: 100%;
            }
            
            .quiz-title-container {
                width: 100%;
            }
            
            .result-actions {
                flex-direction: column;
            }
            
            .promo-banner {
                padding: 9px;
            }
            
            .promo-banner h2 {
                font-size: 0.6rem;
            }
            
            .promo-banner p {
                font-size: 0.4125rem;
            }
        }
    </style>
</head>
<body>
    <div class="quiz-notification" id="quiz-notification">
        <div class="quiz-notification-content">
            <div class="quiz-notification-title" id="notification-title">Quiz Progress Found</div>
            <div class="quiz-notification-message" id="notification-message">You have an unfinished quiz. Do you want to continue where you left off?</div>
            <div class="quiz-notification-actions">
                <button class="quiz-notification-btn secondary" id="notification-no">Start Fresh</button>
                <button class="quiz-notification-btn primary" id="notification-yes">Continue</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="logo">
            <h1>WHITE COAT WARRIORS</h1>
            <p>Excellence in Educational Assessment</p>
        </div>

        <div id="signin-page" class="page active">
            <div class="promo-banner">
                <h2><i class="fas fa-graduation-cap"></i> Unlock Your Potential with WHITE COAT WARRIORS</h2>
                <p>Boost your preparation with WHITE COAT WARRIORS's realistic online tests, crafted by experts to mirror the actual exam's pattern and challenge. Experience instant feedback, detailed analysis, and flexible online access – your pathway to confidence and success!</p>
            </div>
            
            <h2><i class="fas fa-lock"></i> Access Test</h2>
            <p>Sign in or use your access code</p>
            
            <div class="main-page-buttons">
                <button class="btn btn-primary" onclick="showQuizAccessForm()">
                    <i class="fas fa-key"></i>
                    <span>Sign In with Quiz Access Code</span>
                </button>
                <button class="btn btn-primary" onclick="showRegistrationPage()">
                    <i class="fas fa-user-plus"></i>
                    <span>Sign Up to Get Quiz Access</span>
                </button>
                <button class="btn btn-purple" onclick="showDeveloperAccessForm()">
                    <i class="fas fa-code"></i>
                    <span>Developer Access</span>
                </button>
            </div>
            
            <div id="developer-access-form" class="quiz-access-section">
                <h3><i class="fas fa-user-secret"></i> Developer Login</h3>
                <div class="password-container input-container">
                    <input type="password" id="developerPassword" class="form-input" placeholder="Enter the Developer Password">
                    <i class="fas fa-eye-slash input-icon" id="toggleDeveloperPassword"></i>
                </div>
                <button class="btn btn-purple" onclick="checkDeveloperPassword()">
                    <span>Log In</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
                <div id="dev-error-box" class="error-box">
                    <i class="fas fa-exclamation-circle"></i> Invalid developer password.
                </div>
            </div>
            
            <div id="quiz-access-form" class="quiz-access-section">
                <h3><i class="fas fa-key"></i> Enter Quiz Access Code</h3>
                <div class="password-container input-container">
                    <input type="password" id="quizAccessCode" class="form-input" placeholder="Enter your 12-Digit Quiz Access Code here">
                    <i class="fas fa-eye-slash input-icon" id="toggleQuizAccessCode"></i>
                </div>
                <button class="btn btn-primary" onclick="accessQuiz(document.getElementById('quizAccessCode').value)">
                    <span>Access Quiz</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
                <div id="quiz-error-box" class="error-box">
                    <i class="fas fa-exclamation-circle"></i> Invalid quiz access code.
                </div>
            </div>
            
        </div>

        <div id="registration-page" class="page">
            <div class="promo-banner">
                <h2><i class="fas fa-graduation-cap"></i> Unlock Your Potential with WHITE COAT WARRIORS</h2>
                <p>Boost your preparation with WHITE COAT WARRIORS's realistic online tests, crafted by experts to mirror the actual exam's pattern and challenge. Experience instant feedback, detailed analysis, and flexible online access – your pathway to confidence and success!</p>
            </div>
            
            <h2><i class="fas fa-user-edit"></i> Student Registration</h2>
            <p>Please provide your details to register</p>
            
            <div class="form-group">
                <label class="form-label"><i class="fas fa-user"></i> Student Name</label>
                <input type="text" id="studentName" class="form-input" placeholder="Enter your full name">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-user-friends"></i> Father Name</label>
                <input type="text" id="fatherName" class="form-input" placeholder="Enter your father's name">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" id="email" class="form-input" placeholder="Enter your email address">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-phone"></i> Mobile Number (WhatsApp)</label>
                <input type="tel" id="mobile" class="form-input" placeholder="+92XXXXXXXXXX">
            </div>
            <div class="form-group">
                <label class="form-label"><i class="fas fa-city"></i> City / District</label>
                <input type="text" id="city" class="form-input" placeholder="Enter your city/district">
            </div>
            <button class="btn btn-primary" onclick="handleRegistration()">
                <span>Submit to Get Access to Quiz</span>
                <i class="fas fa-arrow-right"></i>
            </button>
            <button class="btn btn-red" style="margin-top: 3.75px;" onclick="showPage('signin-page')">
                <i class="fas fa-chevron-left"></i> Back to Home
            </button>
        </div>

        <div id="quiz-page" class="page">
            <div class="promo-banner">
                <h2><i class="fas fa-graduation-cap"></i> Unlock Your Potential with WHITE COAT WARRIORS</h2>
                <p>Boost your preparation with WHITE COAT WARRIORS's realistic online tests, crafted by experts to mirror the actual exam's pattern and challenge. Experience instant feedback, detailed analysis, and flexible online access – your pathway to confidence and success!</p>
            </div>

            <div class="quiz-header">
                <div class="quiz-title-container">
                    <h2 id="quiz-title"></h2>
                    <div class="quiz-info">
                        <span><i class="fas fa-book"></i> Subject: <span id="quiz-subject">English Grammar</span></span>
                        <span><i class="fas fa-clock"></i> Per MCQ: <span id="per-mcq-time">1</span> Minute</span>
                    </div>
                </div>
            </div>
            <div class="timer-container">
                <div class="timer" id="question-timer">60</div>
                <div class="timer total-timer" id="timer">40:00</div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="quiz-progress"></div>
            </div>

            <div class="question-nav" id="question-nav"></div>
            
            <div class="question-container">
                <div class="question-text" id="question-text"></div>
                <div class="options-container" id="options-container"></div>
                <div class="reasoning" id="reasoning">
                    <div class="reasoning-title"><i class="fas fa-lightbulb"></i> Explanation:</div>
                    <div id="reasoning-text"></div>
                </div>
            </div>
            
            <div class="navigation-buttons">
                <button class="nav-btn btn-back" onclick="navigateQuestion('prev')">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <button class="nav-btn btn-next" onclick="navigateQuestion('next')">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
                <button class="nav-btn btn-reasoning disabled" id="reasoning-btn" onclick="toggleReasoning()">
                    <i class="fas fa-lightbulb"></i> Reasoning
                </button>
                <button class="nav-btn btn-submit" onclick="submitTest()">
                    Submit <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>

        <div id="results-page" class="page">
            <div class="results-header-buttons">
                <a id="website-link" href="#" target="_blank" class="btn btn-primary"><i class="fas fa-globe"></i> Website</a>
                <a id="whatsapp-contact-link" href="#" target="_blank" class="btn btn-whatsapp"><i class="fab fa-whatsapp"></i> Whatsapp Contact</a>
                <a id="whatsapp-community-link" href="#" target="_blank" class="btn btn-whatsapp"><i class="fas fa-users"></i> Whatsapp Community</a>
            </div>
            
            <div class="quick-stats">
                <div class="stat-card correct">
                    <div class="stat-value" id="correct-count">0</div>
                    <div class="stat-label">Correct</div>
                </div>
                <div class="stat-card incorrect">
                    <div class="stat-value" id="incorrect-count">0</div>
                    <div class="stat-label">Incorrect</div>
                </div>
                <div class="stat-card unanswered">
                    <div class="stat-value" id="unanswered-count">0</div>
                    <div class="stat-label">Unanswered</div>
                </div>
            </div>
            
            <div class="performance-meter">
                <div class="performance-fill" id="performance-fill"></div>
            </div>
            
            <div class="result-card">
                <h2><i class="fas fa-user-graduate"></i> Student Information</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Detail</th>
                        </tr>
                    </thead>
                    <tbody id="student-info-table"></tbody>
                </table>
            </div>

            <div class="result-card">
                <h2><i class="fas fa-chart-bar"></i> Test Results</h2>
                <table>
                    <tbody id="quiz-results-table"></tbody>
                </table>
            </div>
            
            <div class="result-actions">
                <button class="btn btn-primary" onclick="restartTest()">
                    <i class="fas fa-redo"></i> Retake Full Test
                </button>
                <button class="btn btn-primary" onclick="retakeIncorrect()">
                    <i class="fas fa-bolt"></i> Retake Incorrect Questions
                </button>
                <button class="btn btn-primary" onclick="viewAllMcqs()">
                    <i class="fas fa-clipboard-list"></i> View All MCQs
                </button>
            </div>
        </div>

        <div id="all-mcqs-page" class="page">
            <h2><i class="fas fa-list-alt"></i> All MCQs and Solutions</h2>
            <div class="all-mcqs-list" id="all-mcqs-list"></div>
            <button class="btn btn-primary" onclick="showPage('results-page')">
                <i class="fas fa-arrow-left"></i> Back to Results
            </button>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html><script>// ***************************************************************
// !! IMPORTANT: GOOGLE APPS SCRIPT URL FOR DATA LOGGING !!
const SHEET_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwuJD-NddcLbcaap_utAGs0yXcuVjaDFOUZn9SC1Cjs9h9jLrtGAiaiHDPq7e7H3tkZOg/exec';
// ***************************************************************

// Quiz Data
const quizData_WCW_CHE_007 = [
    {
        question: "A non-linear triatomic molecule's experimental dipole moment value fundamentally supports its non-zero magnitude. Which structural characteristic is most directly inferred from this observation, distinguishing it from a linear counterpart?",
        options: [
            "Symmetrical bond dipole cancellation.",
            "Planar arrangement with identical terminal atoms.",
            "A specific spatial geometry preventing complete vector nullification.",
            "Uniform electron distribution across the molecular framework."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory that Water (H₂O) has an experimental dipole moment of 1.84 D, indicating an angular shape. A hypothetical linear H₂O would have zero dipole moment as bond dipoles would cancel. Therefore, a non-zero dipole moment infers a specific spatial geometry where bond dipoles do not cancel, thus preventing total vector nullification."
    },
    {
        question: "The notably higher observed bond energy for a heteronuclear diatomic species, compared to a value derived from purely covalent atomic contributions, is predominantly a consequence of what inherent bond property?",
        options: [
            "Significant electronegativity differential between the bonded atoms.",
            "Extensive s-s orbital overlap.",
            "Identical electron affinity between participating atoms.",
            "Formation of additional pi bonds through lateral overlap."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory that for HCl, the experimental bond energy is higher than the calculated value, and this 'additional binding energy' is due to the polar nature of the bond (unequal sharing of electrons), which arises from a significant difference in electronegativity between the atoms."
    },
    {
        question: "A central atom forms four single bonds, yet its observed bond angles significantly deviate from the ideal tetrahedral arrangement. This outcome is most reliably attributed to the influence of what specific electronic feature?",
        options: [
            "The delocalization of pi electrons within the molecular structure.",
            "The presence of one or more non-bonding electron pairs on the central atom.",
            "Increased s-character in the bonding hybrid orbitals.",
            "The formation of dative bonds with highly electronegative ligands."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory under VSEPR that lone pairs occupy more space than bond pairs, causing greater repulsion (LP-LP > LP-BP > BP-BP). This increased repulsion from lone pairs causes deviations from ideal bond angles, for example, in NH₃ (107.5°) and H₂O (104.5°) compared to CH₄ (109.5°)."
    },
    {
        question: "In a molecule containing a carbon-carbon double bond, the unhybridized p-orbitals involved are oriented in a manner directly perpendicular to the plane established by which other orbitals?",
        options: [
            "The sigma bonds formed by sp³ hybridized orbitals.",
            "The molecular orbitals of an adjacent triple bond.",
            "The sp² hybrid orbitals used for sigma bonding.",
            "The lone pair orbitals on neighboring atoms."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory for sp² hybridization (e.g., Ethene) that one p orbital remains unhybridized; it is perpendicular to the plane of the sp² orbitals and forms a pi (π) bond through sidewise overlap. The sp² orbitals themselves are oriented in a trigonal planar arrangement."
    },
    {
        question: "The VSEPR model simplifies the treatment of multiple bonds for geometry prediction. This simplification primarily stems from the understanding that multiple bonds, relative to single bonds, are considered as what, in terms of spatial domain?",
        options: [
            "Domains with significantly reduced repulsive forces.",
            "Equivalent to a single electron pair domain.",
            "Regions that actively contract bond angles.",
            "Sites of enhanced lone pair character."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory under VSEPR principles that for structural determination, multiple bonds (double or triple) are treated as a single 'electron pair domain'. This allows for accurate prediction of molecular geometry based on the total number of electron domains."
    },
    {
        question: "Consider a compound with sp³ hybridized central atom. If a significant decrease in the ideal bond angle of 109.5° is observed, which electronic configuration around the central atom is most likely responsible?",
        options: [
            "Four bonding pairs with varying electronegativity.",
            "Three bonding pairs and one lone pair.",
            "One bonding pair and three lone pairs.",
            "Two bonding pairs and two lone pairs."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory that repulsion strength order is LP-LP > LP-BP > BP-BP. For sp³ hybridization, 'Two Bond Pairs, Two Lone Pairs' (e.g., H₂O) leads to a bond angle of 104.5°, a more significant reduction than 'Three Bond Pairs, One Lone Pair' (e.g., NH₃) which has 107.5° from the ideal 109.5°. Therefore, two lone pairs cause a greater reduction."
    },
    {
        question: "A molecule is experimentally determined to possess a dipole moment of 0 D. This specific measurement most reliably provides evidence for which characteristic concerning its internal bond dipoles and molecular structure?",
        options: [
            "All bonds within the molecule are inherently non-polar.",
            "The central atom exhibits sp hybridization.",
            "The vector sum of individual bond dipoles is precisely zero.",
            "The molecule exists exclusively in a bent conformation."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory that Carbon Dioxide (CO₂) has zero dipole moment, confirming its linear structure, as the two polar C=O bond moments act in opposite directions and cancel each other. General Rule: If bond dipoles in a molecule do not exactly cancel out, the molecule is polar. Symmetrical molecules often have zero net dipole moment. Thus, a 0 D dipole moment indicates the vector sum of individual bond dipoles is zero."
    },
    {
        question: "Which statement regarding the fundamental distinction between sigma (σ) and pi (π) bonds, based on Valence Bond Theory, is most accurate?",
        options: [
            "Pi bonds are formed by head-on overlap, while sigma bonds are formed by sidewise overlap.",
            "Sigma bonds exhibit electron density above and below the internuclear axis, unlike pi bonds.",
            "A pi bond can exist independently without a preceding sigma bond, whereas a sigma bond cannot.",
            "Sigma bonds result from linear overlap along the internuclear axis, whereas pi bonds result from parallel overlap perpendicular to it."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory that sigma (σ) bonds are formed by linear (head-on) overlap along the internuclear axis, leading to stronger bonds with electron density concentrated along this axis. Pi (π) bonds are formed by sidewise or parallel overlap of p-orbitals above and below the internuclear axis, are weaker, and cannot exist without a sigma bond."
    },
    {
        question: "The percentage of ionic character in a chemical bond can be quantitatively assessed. This calculation requires which specific experimental and theoretical values?",
        options: [
            "The observed bond length and the theoretical atomic radii.",
            "The observed dipole moment and the calculated dipole moment for a 100% ionic bond.",
            "The experimental bond energy and the electronegativity difference.",
            "The vibrational frequency and the internuclear distance."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory that the formula for Percentage of Ionic Character is (μ_observed / μ_ionic) × 100, where μ_observed is the experimental dipole moment and μ_ionic is calculated for a 100% ionic bond."
    },
    {
        question: "According to Valence Bond Theory, a fundamental limitation in its original formulation was its inability to adequately explain which observed characteristic of the oxygen molecule?",
        options: [
            "Its inherent paramagnetic behavior.",
            "Its relatively high bond dissociation energy.",
            "The presence of a double bond.",
            "Its non-polar nature despite high electronegativity."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory under 'Shortcomings of VBT' that it 'Could not explain the paramagnetic nature of oxygen (which implies unpaired electrons).'"
    },
    {
        question: "A molecule with sp hybridization at its central carbon atom is characterized by specific structural features. Which option correctly describes the arrangement of hybrid and unhybridized orbitals, and the resulting molecular geometry?",
        options: [
            "Two linear sp orbitals, two perpendicular unhybridized p orbitals, resulting in a bent geometry.",
            "Three trigonal planar sp² orbitals, one perpendicular unhybridized p orbital, resulting in a planar geometry.",
            "Four tetrahedral sp³ orbitals, no unhybridized p orbitals, resulting in a pyramidal geometry.",
            "Two linear sp orbitals, two perpendicular unhybridized p orbitals, resulting in a linear geometry."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory for sp hybridization (e.g., Ethyne) that 'One s orbital mixes with one p orbital to form two equivalent sp hybrid orbitals... The two sp orbitals are oriented linearly... Two p orbitals remain unhybridized; they are perpendicular to the linear sp orbitals and form two pi (π) bonds... The molecule is linear.'"
    },
    {
        question: "The concept of 's-character' within hybrid orbitals plays a crucial role in determining bond properties. An increase in the s-character of a hybrid orbital is generally associated with which set of bond characteristics?",
        options: [
            "Weaker, longer, and more reactive bonds.",
            "Stronger, shorter, and less reactive bonds.",
            "Equivalent strength, variable length, and constant reactivity.",
            "Increased polarity, decreased bond energy, and reduced stability."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory under Hybridization that 'Effect of s-character: Higher s-character in a hybrid orbital generally leads to stronger, shorter, and less reactive bonds.'"
    },
    {
        question: "According to VSEPR theory, the relative spatial requirements of different types of electron pairs around a central atom significantly impact molecular geometry. Which option correctly orders these electron pair repulsions from strongest to weakest?",
        options: [
            "Bond pair-Bond pair > Lone pair-Bond pair > Lone pair-Lone pair.",
            "Lone pair-Bond pair > Lone pair-Lone pair > Bond pair-Bond pair.",
            "Lone pair-Lone pair > Lone pair-Bond pair > Bond pair-Bond pair.",
            "Bond pair-Lone pair > Bond pair-Bond pair > Lone pair-Lone pair."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under VSEPR Core Principles: 'Repulsion Strength Order: Lone pair-Lone pair (LP-LP) > Lone pair-Bond pair (LP-BP) > Bond pair-Bond pair (BP-BP).'"
    },
    {
        question: "The observed bond length for a heteronuclear diatomic molecule is typically shorter than the sum of its constituent atomic covalent radii. This specific reduction in length is attributed to what primary factor?",
        options: [
            "An enhanced attraction due to bond polarity.",
            "The formation of multiple pi bonds.",
            "Decreased s-character in the bonding orbitals.",
            "The presence of lone pair repulsions."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory under Bond Length for Heteronuclear Diatomic Molecules that 'Bond length is shortened compared to the sum of individual covalent radii due to the increased difference in electronegativity, which creates polarity and stronger attractive forces between the polar ends.'"
    },
    {
        question: "Valence Bond Theory postulates that covalent bond formation involves the overlap of specific types of atomic orbitals. Which option accurately describes the essential characteristic of these overlapping orbitals as per VBT's core principles?",
        options: [
            "They must be full orbitals containing two paired electrons.",
            "They must be half-filled orbitals, each with one electron of opposite spin.",
            "They can be empty orbitals acting as electron acceptors.",
            "They are always d-orbitals forming coordinate covalent bonds."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory under VBT Core Principles: 'A covalent bond forms by the overlap of half-filled atomic orbitals (each with one electron) from two atoms.' and 'Overlapping orbitals must contain electrons with opposite spins (Pauli exclusion principle).'"
    },
    {
        question: "The dipole moment of NH₃ is experimentally found to be greater than that of NF₃. This comparative observation primarily indicates a crucial difference in what aspect of their molecular electronic structures?",
        options: [
            "The total number of valence electrons around the central atom.",
            "The hybridization state of the central nitrogen atom.",
            "The presence of an unhybridized p-orbital in NH₃.",
            "The relative contribution of lone pair moments to the net dipole."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory that 'NH₃ has a greater dipole moment than NF₃, attributed to lone pair effects.' This implies the lone pair's contribution to the overall molecular dipole moment is more significant in NH₃ than in NF₃, or oriented differently relative to the bond dipoles to enhance the net dipole."
    },
    {
        question: "Which type of hybridization is associated with a trigonal planar arrangement of hybrid orbitals and involves the participation of a single unhybridized p-orbital perpendicular to this plane?",
        options: [
            "sp³ hybridization.",
            "sp hybridization.",
            "sp² hybridization.",
            "dsp² hybridization."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory for sp² hybridization (e.g., Ethene) that 'One s orbital mixes with two p orbitals to form three equivalent sp² hybrid orbitals... The three sp² orbitals are oriented in a trigonal planar arrangement... One p orbital remains unhybridized; it is perpendicular to the plane of the sp² orbitals'."
    },
    {
        question: "The VSEPR theory states that the effect of a bonding electron pair on molecular shape is influenced by the electronegativity of the bonded atom. An *increase* in the electronegativity of the bonded atom has what specific consequence on this effect?",
        options: [
            "It increases the repulsive forces exerted by the bonding pair.",
            "It expands the spatial domain occupied by the bonding pair.",
            "It decreases the overall bond angle around the central atom.",
            "It decreases the effect of the bonding electron pair."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory under VSEPR Core Principles that 'The effect of a bonding electron pair decreases with increasing electronegativity of the bonded atom.' This is because higher electronegativity pulls the electron density away from the central atom, reducing its repulsive influence."
    },
    {
        question: "Boron compounds frequently exhibit 'electron-deficient' characteristics. This behavior arises primarily from which fundamental aspect of boron's valence electron configuration in such compounds?",
        options: [
            "The inability of boron to form pi bonds.",
            "The presence of d-orbitals in its valence shell.",
            "A tendency to form fewer than eight valence electrons.",
            "Its exceptionally high electronegativity."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under 'Additional Concepts' that 'Many boron compounds lack an octet of electrons (often having six), making them electron-deficient and acidic.' This directly refers to forming fewer than eight valence electrons."
    },
    {
        question: "Which molecule, despite containing polar covalent bonds, is correctly described as having a zero net dipole moment due to its symmetrical geometry?",
        options: [
            "Carbon dioxide (CO₂).",
            "Water (H₂O).",
            "Ammonia (NH₃).",
            "Sulfur dioxide (SO₂)."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory that 'Carbon Dioxide (CO₂): Has zero dipole moment, confirming its linear structure. The two polar C=O bond moments act in opposite directions and cancel each other, making the molecule non-polar.' BF₃ is another example mentioned but not an option here."
    },
    {
        question: "The concept of hybridization was introduced to address specific inconsistencies in early bonding theories. What primary inadequacy of Valence Bond Theory was hybridization designed to rectify, particularly regarding carbon's bonding?",
        options: [
            "Its failure to explain the paramagnetic nature of oxygen.",
            "Its inability to account for coordinate covalent bonds.",
            "Its difficulty in explaining the equivalence of all C-H bonds in methane and tetrahedral geometry.",
            "Its overestimation of bond energies in polar molecules."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under Hybridization that its 'Purpose (Pauling and Slater)' is to 'Explains how atoms form more bonds than their half-filled orbitals might suggest and how molecular geometries are achieved (e.g., all C-H bonds in methane are identical).'"
    },
    {
        question: "A covalent bond formed by the sidewise overlap of atomic orbitals, with electron density located above and below the internuclear axis, is exclusively categorized as what type of bond?",
        options: [
            "A pi bond.",
            "A sigma bond.",
            "An ionic bond.",
            "A coordinate bond."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory that 'Pi (π) Bond: Formed by sidewise or parallel overlap of half-filled p-orbitals... Electron density is located above and below the internuclear axis, not along it.'"
    },
    {
        question: "Experimental determination of molecular dipole moment utilizes which physical phenomenon to deduce its value?",
        options: [
            "Measurement of bond dissociation enthalpy.",
            "Observation of atomic absorption spectra.",
            "Interaction with an electric condenser to measure field strength decrease.",
            "Analysis of X-ray diffraction patterns for bond lengths."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under 'Definition of Dipole Moment' that its 'Measurement' involves 'Experimentally determined using an electric condenser. Polar molecules align in an electric field, causing a decrease in field strength, from which dipole moment is deduced.'"
    },
    {
        question: "Considering bond lengths for carbon-carbon bonds, which order correctly ranks the bond types from longest to shortest?",
        options: [
            "C≡C > C=C > C-C.",
            "C-C > C=C > C≡C.",
            "C=C > C-C > C≡C.",
            "C-C > C≡C > C=C."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory under Bond Length for Carbon-Carbon Bonds that 'Bond length order: C-C > C=C > C≡C (reverse of bond energy).'"
    },
    {
        question: "The phenomenon of hydrogen bonding is described as a 'flexible bond' and is crucial for specific biological structures. This flexibility allows for temporary changes, as observed in hair, due to which specific characteristic?",
        options: [
            "Its susceptibility to breakage and reformation by water and heat.",
            "Its purely electrostatic nature.",
            "Its formation via strong covalent interactions.",
            "Its dependence on d-orbital overlap."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory under 'Hydrogen Bonds' that they are 'Flexible bonds responsible for the shape of proteins like keratin in hair. Easily broken by water and heat, allowing temporary changes in hair shape... Re-bonding occurs upon drying, fixing the new shape.'"
    },
    {
        question: "Which specific VBT shortcoming relates to its inability to describe compounds where an electron pair is shared, but both electrons originate from only one of the participating atoms?",
        options: [
            "Inability to explain the existence of odd-electron molecules.",
            "Failure to account for the paramagnetic nature of O₂.",
            "Inability to explain coordinate covalent bonds.",
            "Difficulty in predicting molecular geometry accurately."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under 'Shortcomings of VBT' that it 'Failed to explain the formation of coordinate covalent bonds'. Coordinate covalent bonds are defined by both electrons coming from one atom."
    },
    {
        question: "The equilibrium distance between the nuclei of two covalently bonded atoms, known as bond length, is determined by an intricate balance. This balance primarily exists between which types of forces?",
        options: [
            "Attractive forces between nuclei and electrons, and repulsive forces between nuclei and between electrons.",
            "Only attractive forces between nuclei.",
            "Only repulsive forces between electron clouds.",
            "Only gravitational forces between atoms."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory under Bond Length that 'It's a result of the equilibrium between attractive and repulsive forces.' In the context of covalent bonding, these forces involve attraction between nuclei and electrons, and repulsion between nuclei and between electron clouds."
    },
    {
        question: "A molecule described as 'trigonal planar' according to VSEPR theory, despite having polar bonds, is non-polar overall. This non-polarity specifically arises from what fundamental characteristic of its bond dipoles?",
        options: [
            "The bond dipoles are oriented perpendicular to the molecular plane.",
            "The individual bond dipoles are inherently zero in magnitude.",
            "The bond dipoles are arranged symmetrically, leading to exact cancellation.",
            "The central atom lacks any lone pairs, forcing non-polarity."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory for BF₃ (Trigonal planar, 3 bond pairs, 0 lone pairs) that 'BF₃ is a non-polar molecule despite polar B-F bonds due to symmetry.' This symmetry ensures that the vector sum of the bond dipoles is zero, leading to overall non-polarity."
    },
    {
        question: "Ethane (C₂H₆) undergoes a reaction leading to ethene (C₂H₄). This transformation involves a change in the hybridization state of the carbon atoms. Which statement accurately describes this change and its immediate structural consequences?",
        options: [
            "From sp² to sp³, leading to a decrease in bond angle and increased linearity.",
            "From sp³ to sp², leading to an increase in bond angle and planar geometry.",
            "From sp to sp³, leading to a decrease in s-character and increased reactivity.",
            "From sp² to sp, leading to a decrease in bond length and increased bond energy."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory that Alkanes (like Ethane) are sp³ hybridized (tetrahedral, 109.5°), and Alkenes (like Ethene) are sp² hybridized (trigonal planar, 120°). Therefore, changing from sp³ to sp² involves an increase in bond angle (109.5° to 120°) and a change from a tetrahedral to a planar geometry."
    },
    {
        question: "The VSEPR model's primary goal in predicting molecular geometry relies on a fundamental principle regarding electron pair distribution. This principle dictates that electron pairs will arrange themselves to achieve what specific outcome?",
        options: [
            "Maximum overlap of atomic orbitals.",
            "Minimum energy configuration by maximizing attractive forces.",
            "Maximum distance from each other to minimize repulsion.",
            "Perfect symmetry regardless of electron pair type."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under VSEPR Core Principles that 'These electron pairs arrange themselves in space as far apart as possible to minimize repulsion and maximize distance, thus determining molecular geometry.'"
    },
    {
        question: "A molecule is described as linear with a 180° bond angle, formed from two bond pairs and no lone pairs. According to VSEPR theory, which central atom hybridization would be consistent with this description?",
        options: [
            "sp hybridization.",
            "sp³ hybridization.",
            "sp² hybridization.",
            "dsp² hybridization."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory for sp hybridization that the 'Orientation: The two sp orbitals are oriented linearly' and 'Bond Angle: Ideal 180°.' Also, VSEPR predicts a linear shape for '2 Bond Pairs, 0 Lone Pairs' (e.g., BeCl₂, HgCl₂)."
    },
    {
        question: "The unit 'Debye' is commonly used for measuring dipole moment. What is the fundamental SI unit equivalent to Debye, and which conversion factor links them?",
        options: [
            "Joule meter (Jm); 1 D = 10⁻¹⁹ Jm.",
            "Newton meter (Nm); 1 D = 10⁻³⁴ Nm.",
            "Coulomb meter (Cm); 1 D = 3.336 × 10⁻³⁰ Cm.",
            "Electron volt meter (eVm); 1 D = 1.602 × 10⁻¹⁹ eVm."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under 'Definition of Dipole Moment' that 'Units: Debye (D) is common, SI unit is Coulomb meter (Cm). Conversion Factor: 1 D = 3.336 × 10⁻³⁰ Cm.'"
    },
    {
        question: "Which of the following bonds typically exhibits the highest bond energy?",
        options: [
            "A carbon-carbon triple bond (C≡C).",
            "A carbon-carbon single bond (C-C).",
            "A carbon-carbon double bond (C=C).",
            "A carbon-hydrogen bond (C-H)."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory under Bond Energy for 'Carbon-Carbon Bonds: Bond energy order: C≡C > C=C > C-C.' While C-H is not compared directly, among the C-C options, the triple bond has the highest energy."
    },
    {
        question: "According to the Valence Shell Electron Pair Repulsion (VSEPR) theory, how are multiple covalent bonds (double or triple) treated when determining molecular geometry?",
        options: [
            "Each individual bond within a multiple bond is considered a separate electron pair.",
            "They are considered as a single electron pair domain for repulsion purposes.",
            "They are ignored in molecular geometry prediction due to their delocalized nature.",
            "They exert stronger repulsive forces than lone pairs and single bond pairs combined."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory under VSEPR Core Principles that 'For structural determination, multiple bonds (double or triple) are treated as a single 'electron pair domain.''"
    },
    {
        question: "The promotion of an electron from a 2s orbital to a 2p orbital in carbon, prior to hybridization, is essential for forming four equivalent bonds. This preparatory step primarily facilitates what subsequent process?",
        options: [
            "The formation of pi bonds via parallel overlap.",
            "The cancellation of bond dipoles in symmetrical molecules.",
            "The mixing of atomic orbitals into an equivalent set.",
            "The localization of electron density along the internuclear axis."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory for sp³ hybridization (e.g., CH₄) that 'Carbon's 2s electron is promoted to a 2p orbital (excited state), then 1s and 3p orbitals hybridize to form four sp³ orbitals.' The promotion creates enough half-filled orbitals for hybridization, which is the 'mixing of atomic orbitals into an equivalent set.'"
    },
    {
        question: "An unshared pair of electrons on a central atom is termed a lone pair. Relative to a bonding pair, a lone pair typically occupies how much spatial volume and exerts what kind of repulsive force?",
        options: [
            "Less space and weaker repulsion.",
            "More space and weaker repulsion.",
            "Less space and stronger repulsion.",
            "More space and stronger repulsion."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory under VSEPR Core Principles that 'Lone pairs occupy more space than bond pairs, causing greater repulsion.' Specifically, LP-LP > LP-BP > BP-BP."
    },
    {
        question: "Valence Bond Theory struggles to explain the existence of H₂⁺. This specific deficiency highlights its limitation in accounting for what kind of chemical species?",
        options: [
            "Molecules containing an odd number of electrons.",
            "Molecules with highly polar bonds.",
            "Molecules with only sigma bonds.",
            "Molecules involving coordinate covalent bonding."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory under 'Shortcomings of VBT' that it was 'Unable to account for the formation of odd-electron molecules or ions (e.g., H₂⁺).'"
    },
    {
        question: "Which of the following compounds is an example of a molecule with sp² hybridization, characterized by a trigonal planar electron geometry and the presence of both sigma and pi bonds?",
        options: [
            "Methane (CH₄).",
            "Ethyne (C₂H₂).",
            "Ethene (C₂H₄).",
            "Ammonia (NH₃)."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory that 'sp² Hybridization (e.g., Ethene (C₂H₄), Alkenes)... The three sp² orbitals are oriented in a trigonal planar arrangement... The unhybridized p-orbital... forms a pi (π) bond... The C=C double bond consists of one sigma and one pi bond.'"
    },
    {
        question: "The 'additional binding energy' observed in polar bonds like HCl, beyond that of a purely covalent bond, contributes to which specific characteristic of the bond?",
        options: [
            "Enhanced bond strength.",
            "Decreased s-character of the bonding orbitals.",
            "Reduced overall polarity.",
            "Increased bond length."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory for HCl that the 'additional binding energy' is 'due to the polar nature of the bond (unequal sharing of electrons), indicating a stronger bond.' Higher bond energy directly signifies a stronger chemical bond."
    },
    {
        question: "A covalent bond between two identical atoms (homonuclear) is expected to exhibit which specific set of properties regarding polarity and ionic character?",
        options: [
            "Polar bond, with significant ionic character.",
            "Non-polar bond, with zero ionic character.",
            "Polar bond, with zero ionic character.",
            "Non-polar bond, with partial ionic character."
        ],
        correctAnswer: 1,
        reasoning: "It's mentioned in Textbook theory under 'Ionic Character of Bonds (based on Electronegativity Difference)' that for 'Identical Atoms: Electronegativity difference is zero; bond is non-polar, zero ionic character.'"
    },
    {
        question: "Which set of conditions for electronegativity difference accurately delineates a bond as predominantly ionic?",
        options: [
            "Between 0.4 and 1.7.",
            "Exactly 0.4.",
            "Less than 0.4.",
            "Greater than 1.7."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory under 'Ionic Character of Bonds (based on Electronegativity Difference)' that for '> 1.7: Ionic bond.'"
    },
    {
        question: "In sp³ hybridization, the contribution of p-orbital character to each hybrid orbital is how much?",
        options: [
            "50%.",
            "33.33%.",
            "75%.",
            "25%."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory for sp³ Hybridization that 'Character: 25% s-character, 75% p-character.' One s and three p orbitals contribute, so 3 out of 4 parts are p, which is 75%."
    },
    {
        question: "The comparison of dipole moments between H₂O (1.84 D) and NH₃ (1.47 D) reveals that H₂O has a greater dipole moment. This difference, despite similar electron pair configurations, is fundamentally linked to what aspect of their respective geometries?",
        options: [
            "The presence of lone pairs only in NH₃.",
            "The more symmetrical distribution of atoms in NH₃.",
            "The absence of polarity in H₂O bonds.",
            "The specific bond angles resulting from lone pair repulsion."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory for Dipole Moment Applications that 'H₂O has a greater dipole moment than NH₃. Angular shapes generally have higher dipole moments than trigonal pyramidal for similar electron pair configurations.' This refers to the specific bond angles (104.5° for H₂O, 107.5° for NH₃) influenced by lone pair repulsion, leading to differing vector sums."
    },
    {
        question: "A molecule adopts an angular (bent) shape with a bond angle significantly reduced from 120° (e.g., SnCl₂ at 95°). According to VSEPR theory, this geometry is characteristic of a central atom surrounded by what specific arrangement of electron pairs?",
        options: [
            "Two bond pairs and two lone pairs.",
            "Three bond pairs and zero lone pairs.",
            "Two bond pairs and one lone pair.",
            "Four bond pairs and zero lone pairs."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under VSEPR Applications for 'Three Electron Pairs (Total)' that '2 Bond Pairs, 1 Lone Pair (e.g., SnCl₂, SO₂): Angular (bent) shape, bond angle reduced from 120° (e.g., SnCl₂ has 95°) due to LP-BP repulsion.'"
    },
    {
        question: "What is the primary characteristic of electron density distribution in a sigma (σ) bond?",
        options: [
            "Concentrated above and below the internuclear axis.",
            "Equally dispersed throughout the entire molecule.",
            "Concentrated along the internuclear axis.",
            "Localized in regions far from the bonded nuclei."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory for Sigma (σ) Bond that 'Electron density is concentrated along the internuclear axis.'"
    },
    {
        question: "The Valence Bond Theory's postulate that orbitals with two paired electrons do not participate in bonding is directly derived from which fundamental principle of quantum mechanics?",
        options: [
            "Heisenberg's Uncertainty Principle.",
            "Aufbau Principle.",
            "Hund's Rule of Maximum Multiplicity.",
            "Pauli Exclusion Principle."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory under VBT Core Principles that 'Overlapping orbitals must contain electrons with opposite spins (Pauli exclusion principle).' If an orbital has two paired electrons with opposite spins, it is already 'full' according to Pauli's principle and cannot accept another electron for sharing, hence it does not participate in forming a new bond by sharing electrons."
    },
    {
        question: "Benzene and phenol are given as examples of molecules exhibiting sp² hybridization. This implies that the carbon atoms involved in these structures are characterized by what specific geometric and bonding features?",
        options: [
            "Linear arrangement with triple bonds.",
            "Tetrahedral arrangement with single bonds only.",
            "Trigonal planar arrangement with both sigma and pi bonds.",
            "Pyramidal arrangement with lone pairs."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under 'sp² Hybridization (e.g., Ethene (C₂H₄), Alkenes, Benzene, Phenol)' that it results in 'trigonal planar arrangement' and involves both sigma and pi bonds (from the unhybridized p-orbital)."
    },
    {
        question: "The VSEPR theory states that repulsion forces decrease with increasing bond angles. This implies that to minimize repulsion, electron pairs will arrange themselves to achieve what characteristic regarding the angles between them?",
        options: [
            "The largest possible bond angles.",
            "The smallest possible bond angles.",
            "Equidistant distribution, but not necessarily largest angles.",
            "Angles that are always exactly 90 degrees."
        ],
        correctAnswer: 0,
        reasoning: "It's mentioned in Textbook theory under VSEPR Core Principles that 'Repulsion forces decrease with increasing bond angles.' Therefore, to minimize repulsion, electron pairs will try to maximize their separation, leading to the largest possible bond angles."
    },
    {
        question: "Consider a molecule with a central atom having two bond pairs and two lone pairs. According to VSEPR theory, what is its electron domain geometry and its molecular shape, respectively?",
        options: [
            "Trigonal planar, bent.",
            "Tetrahedral, trigonal pyramidal.",
            "Tetrahedral, bent.",
            "Trigonal bipyramidal, linear."
        ],
        correctAnswer: 2,
        reasoning: "It's mentioned in Textbook theory under VSEPR Applications for 'Four Electron Pairs (Total)' that '2 Bond Pairs, 2 Lone Pairs (e.g., H₂O, H₂S): Angular (bent) shape.' The electron domain geometry for 4 total electron pairs (2 bond + 2 lone) is always tetrahedral."
    },
    {
        question: "A molecule's geometry is described as 'linear' with an ideal bond angle of 180°. Which VSEPR electron pair configuration around the central atom corresponds to this description?",
        options: [
            "Three bond pairs, zero lone pairs.",
            "Two bond pairs, one lone pair.",
            "Four bond pairs, zero lone pairs.",
            "Two bond pairs, zero lone pairs."
        ],
        correctAnswer: 3,
        reasoning: "It's mentioned in Textbook theory under VSEPR Applications for 'Two Electron Pairs (Total)' that '2 Bond Pairs, 0 Lone Pairs (e.g., BeCl₂, HgCl₂): Linear shape, 180° bond angle.'"
    }
];

// Constants
const QUIZ_ACCESS_CODE = "PreMium-A-12345";
const DEV_ACCESS_CODE = "Dev-PDA-001";
const ACADEMY_NAME = "WHITE COAT WORRIORS ";
const QUIZ_SUBJECT = "Chemistry ";
const WEBSITE_LINK = "https://premiumdoctoracademy.com";
const WHATSAPP_CONTACT = "03287743851";
const WHATSAPP_COMMUNITY = "https://whatsapp.com/channel/0029VaFCIU6EquiOlXWcNR1X";
const TIME_PER_MCQ = 60;
const MARK_PER_MCQ = 1;
const NEGATIVE_MARKING = 0;

// Global state variables
let currentQuizId = 'WCW-CHE-007';
let quizData = quizData_WCW_CHE_007;
let currentQuestion = 0;
let userAnswers = Array(quizData.length).fill(null);
let timeLeft;
let questionTimeLeft;
let totalTimeInterval;
let questionTimeInterval;
let studentData = {};
let studentAccessCode = "";

// DOM elements
const questionNavEl = document.getElementById('question-nav');
const questionTextEl = document.getElementById('question-text');
const optionsContainerEl = document.getElementById('options-container');
const reasoningEl = document.getElementById('reasoning');
const reasoningTextEl = document.getElementById('reasoning-text');
const quizTitleEl = document.getElementById('quiz-title');
const quizSubjectEl = document.getElementById('quiz-subject');
const perMcqTimeEl = document.getElementById('per-mcq-time');
const totalTimerEl = document.getElementById('timer');
const questionTimerEl = document.getElementById('question-timer');
const quizProgressEl = document.getElementById('quiz-progress');
const studentInfoTable = document.getElementById('student-info-table');
const quizResultsTable = document.getElementById('quiz-results-table');
const allMcqsList = document.getElementById('all-mcqs-list');
const devPasswordInput = document.getElementById('developerPassword');
const devErrorBox = document.getElementById('dev-error-box');
const quizAccessCodeInput = document.getElementById('quizAccessCode');
const quizAccessErrorBox = document.getElementById('quiz-error-box');
const toggleDevPasswordIcon = document.getElementById('toggleDeveloperPassword');
const toggleQuizCodeIcon = document.getElementById('toggleQuizAccessCode');
const websiteLinkEl = document.getElementById('website-link');
const whatsappContactLinkEl = document.getElementById('whatsapp-contact-link');
const whatsappCommunityLinkEl = document.getElementById('whatsapp-community-link');
const reasoningBtn = document.getElementById('reasoning-btn');
const quizNotificationEl = document.getElementById('quiz-notification');
const notificationTitleEl = document.getElementById('notification-title');
const notificationMessageEl = document.getElementById('notification-message');
const notificationYesBtn = document.getElementById('notification-yes');
const notificationNoBtn = document.getElementById('notification-no');
const correctCountEl = document.getElementById('correct-count');
const incorrectCountEl = document.getElementById('incorrect-count');
const unansweredCountEl = document.getElementById('unanswered-count');
const performanceFillEl = document.getElementById('performance-fill');


/**
 * @description Sends data to the Google Apps Script endpoint.
 * @param {object} data - The payload containing type ('registration' or 'quiz_result') and data.
 */
function sendDataToSheet(data) {
    if (!SHEET_SCRIPT_URL || SHEET_SCRIPT_URL.includes('YOUR_DEPLOYED_WEB_APP_URL')) {
        console.error('SHEET_SCRIPT_URL is not configured. Data not sent to Google Sheet.');
        return Promise.resolve({ success: false, message: 'Script URL not configured.' });
    }

    return fetch(SHEET_SCRIPT_URL, {
        method: 'POST',
        // 'no-cors' is necessary for Apps Script to accept cross-origin POST requests from a web page
        mode: 'no-cors',
        cache: 'no-cache',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => {
        // Cannot read response body with 'no-cors', assume request was sent successfully
        return { success: true, message: 'Request sent to Google Script.' };
    })
    .catch(error => {
        console.error('Sheet Data Send Error:', error);
        return { success: false, message: 'Failed to send request to Google Script.' };
    });
}


// Initialization
document.addEventListener('DOMContentLoaded', () => {
    const storedStudentData = localStorage.getItem('studentData');
    if (storedStudentData) {
        studentData = JSON.parse(storedStudentData);
        document.getElementById('studentName').value = studentData['Student Name'] || '';
        document.getElementById('fatherName').value = studentData['Father Name'] || '';
        document.getElementById('email').value = studentData['Email'] || '';
        document.getElementById('mobile').value = studentData['Mobile'] || '';
        document.getElementById('city').value = studentData['City'] || '';
    }
    const storedCode = localStorage.getItem('studentAccessCode');
    if (storedCode) {
        studentAccessCode = storedCode;
    }
    
    showPage('signin-page');
    
    if (toggleDevPasswordIcon) toggleDevPasswordIcon.addEventListener('click', () => togglePasswordVisibility('developerPassword', 'toggleDeveloperPassword'));
    if (toggleQuizCodeIcon) toggleQuizCodeIcon.addEventListener('click', () => togglePasswordVisibility('quizAccessCode', 'toggleQuizAccessCode'));
});

function showQuizNotification(title, message, type = 'info') {
    const allowedNotifications = ['Registration Successful', 'Access Granted', 
                                 'Quiz Completed!', 'Quiz Reset', 'Registration Error', 'Submission Error', 'Registration Warning'];
    
    if (!allowedNotifications.includes(title)) {
        return;
    }
    
    notificationTitleEl.textContent = title;
    notificationMessageEl.textContent = message;
    
    quizNotificationEl.classList.remove('warning', 'error');
    
    if (type === 'warning') {
        quizNotificationEl.classList.add('warning');
    } else if (type === 'error') {
        quizNotificationEl.classList.add('error');
    }
    
    quizNotificationEl.classList.add('show');
    
    setTimeout(() => {
        if (quizNotificationEl.classList.contains('show')) {
            hideQuizNotification();
        }
    }, 5000);
}

function hideQuizNotification() {
    quizNotificationEl.classList.remove('show');
}

function showPage(pageId) {
    const pages = document.querySelectorAll('.page');
    pages.forEach(page => page.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
    document.querySelectorAll('.error-box, .success-box').forEach(el => el.style.display = 'none');
}

function togglePasswordVisibility(inputID, iconID) {
    const passwordInput = document.getElementById(inputID);
    const toggleIcon = document.getElementById(iconID);
    
    if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.classList.remove('fa-eye-slash');
        toggleIcon.classList.add('fa-eye');
    } else {
        passwordInput.type = 'password';
        toggleIcon.classList.remove('fa-eye');
        toggleIcon.classList.add('fa-eye-slash');
    }
}

function showQuizAccessForm() {
    document.getElementById('quiz-access-form').style.display = 'flex';
    document.getElementById('developer-access-form').style.display = 'none';
}

function showDeveloperAccessForm() {
    document.getElementById('developer-access-form').style.display = 'flex';
    document.getElementById('quiz-access-form').style.display = 'none';
}

function showRegistrationPage() {
    showPage('registration-page');
}

// Registration Handler
function generateAccessCode(studentName, fatherName) {
    const studentInitials = studentName.split(' ').map(n => n[0]).join('').toUpperCase();
    const fatherInitials = fatherName.split(' ').map(n => n[0]).join('').toUpperCase();
    const uniqueId = Math.random().toString(36).substring(2, 7).toUpperCase();

    return `${ACADEMY_NAME.replace(/\s+/g, '-')}-${studentInitials}${fatherInitials}-${uniqueId}`;
}

function handleRegistration() {
    const sName = document.getElementById('studentName').value.trim();
    const fName = document.getElementById('fatherName').value.trim();
    const email = document.getElementById('email').value.trim();
    const mobile = document.getElementById('mobile').value.trim();
    const city = document.getElementById('city').value.trim();
    
    if (!sName || !fName || !email || !mobile || !city) {
        showQuizNotification('Registration Error', 'Please fill in all the registration details.', 'error');
        return;
    }
    
    // Generate access code
    const generatedCode = generateAccessCode(sName, fName);
    studentAccessCode = generatedCode;

    studentData = {
        'Student Name': sName,
        'Father Name': fName,
        'Email': email,
        'Mobile': mobile,
        'City': city
    };

    // --- NEW: SEND REGISTRATION DATA TO GOOGLE SHEET ---
    const registrationDataToSend = {
        type: 'registration',
        accessCode: generatedCode,
        studentName: sName,
        fatherName: fName,
        email: email,
        mobile: mobile,
        city: city
    };
    
    sendDataToSheet(registrationDataToSend)
        .then(response => {
            console.log('Sheet Registration Response:', response);
            showQuizNotification('Registration Successful', `Your code: ${generatedCode}. Data submitted to sheet.`, 'info');
        })
        .catch(error => {
            console.error('Sheet Registration Error:', error);
            showQuizNotification('Registration Warning', `Registration saved locally, but sheet submission failed.`, 'warning');
        });
    // ----------------------------------------------------
    
    // Store data locally
    localStorage.setItem('studentAccessCode', generatedCode);
    localStorage.setItem('studentData', JSON.stringify(studentData));
    
    const registrations = JSON.parse(localStorage.getItem('wcwRegistrations') || '[]');
    registrations.push({
        ...studentData,
        accessCode: generatedCode,
        timestamp: new Date().toISOString()
    });
    localStorage.setItem('wcwRegistrations', JSON.stringify(registrations));
    
    
    // Start the quiz after registration
    startQuiz('WCW-CHE-007', 'Student', generatedCode);
}

// Quiz Access Handler
function checkDeveloperPassword() {
    devErrorBox.style.display = 'none';
    if (devPasswordInput.value === DEV_ACCESS_CODE) {
        showQuizNotification('Access Granted', 'Welcome! You have successfully logged in as a developer.', 'info');
        startQuiz('WCW-CHE-007', 'Developer', DEV_ACCESS_CODE);
    } else {
        devErrorBox.style.display = 'block';
    }
}

function accessQuiz(inputCode) {
    const errorBox = document.getElementById('quiz-error-box');
    errorBox.style.display = 'none';
    
    const storedStudentCode = localStorage.getItem('studentAccessCode');
    
    if (inputCode === QUIZ_ACCESS_CODE || inputCode === DEV_ACCESS_CODE || inputCode === storedStudentCode) {
        showQuizNotification('Access Granted', 'Welcome! You can now start the quiz.', 'info');
        startQuiz('WCW-CHE-007', 'Student', inputCode);
    } else {
        errorBox.style.display = 'block';
    }
}

function startQuiz(quizId, userType, code) {
    currentQuizId = quizId;
    quizData = quizData_WCW_CHE_007;
    
    // Always start fresh - no progress restoration
    currentQuestion = 0;
    userAnswers = Array(quizData.length).fill(null);
    
    timeLeft = quizData.length * TIME_PER_MCQ;
    questionTimeLeft = TIME_PER_MCQ;
    
    localStorage.setItem('lastAccessCode', code);

    showPage('quiz-page');
    initQuiz();
}

// Quiz Logic
function initQuiz() {
    quizSubjectEl.textContent = QUIZ_SUBJECT;
    perMcqTimeEl.textContent = Math.floor(TIME_PER_MCQ / 60);
    
    websiteLinkEl.href = WEBSITE_LINK;
    whatsappContactLinkEl.href = 'https://wa.me/' + WHATSAPP_CONTACT;
    whatsappCommunityLinkEl.href = WHATSAPP_COMMUNITY;
    
    quizTitleEl.textContent = `Test - ID: ${currentQuizId}`;
    renderQuestionNav();
    renderQuestion();

    if (totalTimeInterval) clearInterval(totalTimeInterval);
    if (questionTimeInterval) clearInterval(questionTimeInterval);
    
    totalTimeInterval = setInterval(updateTotalTimer, 1000);
    questionTimeInterval = setInterval(updateQuestionTimer, 1000);
}

function updateTotalTimer() {
    if (timeLeft > 0) {
        timeLeft--;
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        totalTimerEl.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    } else {
        clearInterval(totalTimeInterval);
        submitTest(true);
    }
}

function updateQuestionTimer() {
    if (questionTimeLeft > 0) {
        questionTimeLeft--;
        questionTimerEl.textContent = `${questionTimeLeft}`;
    } else {
        questionTimeLeft = TIME_PER_MCQ;
        navigateQuestion('next');
    }
}

function renderQuestionNav() {
    questionNavEl.innerHTML = '';
    quizData.forEach((_, index) => {
        const navItem = document.createElement('div');
        navItem.classList.add('question-nav-item');
        navItem.textContent = index + 1;
        navItem.onclick = () => navigateQuestion(index);
        
        if (index === currentQuestion) {
            navItem.classList.add('current');
        } else if (userAnswers[index] !== null) {
            navItem.classList.add('solved');
        } else if (userAnswers.slice(0, index).some(ans => ans !== null) || index < currentQuestion) {
             navItem.classList.add('visited');
        }
        
        questionNavEl.appendChild(navItem);
    });
    updateProgressBar();
}

function updateProgressBar() {
    const solvedCount = userAnswers.filter(answer => answer !== null).length;
    const progress = (solvedCount / quizData.length) * 100;
    quizProgressEl.style.width = `${progress}%`;
}

function renderQuestion() {
    reasoningEl.style.display = 'none';
    reasoningBtn.classList.add('disabled');
    const question = quizData[currentQuestion];
    questionTextEl.textContent = `${currentQuestion + 1}. ${question.question}`;
    
    optionsContainerEl.innerHTML = '';
    question.options.forEach((option, index) => {
        const optionEl = document.createElement('div');
        optionEl.classList.add('option');
        optionEl.textContent = option;
        
        const isAnswered = userAnswers[currentQuestion] !== null;

        if (!isAnswered) {
            optionEl.onclick = () => selectOption(index);
        } else {
            if (index === question.correctAnswer) {
                optionEl.classList.add('correct');
            } else if (index === userAnswers[currentQuestion]) {
                optionEl.classList.add('incorrect');
            }
        }
        
        if (userAnswers[currentQuestion] === index) {
            optionEl.classList.add('selected');
        }

        optionsContainerEl.appendChild(optionEl);
    });
    
    questionTimeLeft = TIME_PER_MCQ;
    questionTimerEl.textContent = `${questionTimeLeft}`;
    renderQuestionNav();
    
    if (userAnswers[currentQuestion] !== null) {
        reasoningBtn.classList.remove('disabled');
    }
}

function selectOption(optionIndex) {
    const question = quizData[currentQuestion];
    userAnswers[currentQuestion] = optionIndex;
    
    reasoningBtn.classList.remove('disabled');
    
    const options = optionsContainerEl.querySelectorAll('.option');
    options.forEach((option, index) => {
        option.onclick = null;
        option.classList.remove('selected', 'correct', 'incorrect');
        
        if (index === question.correctAnswer) {
            option.classList.add('correct');
        } else if (index === optionIndex) {
            option.classList.add('incorrect');
        }
        
        if (index === optionIndex) {
             option.classList.add('selected');
        }
    });

    renderQuestionNav();
    
    setTimeout(() => {
        navigateQuestion('next');
    }, 800);
}

function navigateQuestion(direction) {
    const totalQuestions = quizData.length;
    let nextIndex;

    if (typeof direction === 'number') {
        nextIndex = direction;
    } else if (direction === 'next') {
        nextIndex = (currentQuestion + 1) % totalQuestions;
    } else if (direction === 'prev') {
        nextIndex = (currentQuestion - 1 + totalQuestions) % totalQuestions;
    } else {
        return;
    }

    if (nextIndex === currentQuestion) return;
    
    currentQuestion = nextIndex;
    renderQuestion();
}

function toggleReasoning() {
    if (reasoningBtn.classList.contains('disabled')) return;
    
    const question = quizData[currentQuestion];
    if (reasoningEl.style.display === 'block') {
        reasoningEl.style.display = 'none';
    } else {
        reasoningTextEl.textContent = question.reasoning;
        reasoningEl.style.display = 'block';
    }
}

function submitTest(isTimeout = false) {
    if (!isTimeout && !confirm('Are you sure you want to submit the quiz?')) {
        return;
    }
    
    clearInterval(totalTimeInterval);
    clearInterval(questionTimeInterval);

    let correct = 0;
    let incorrect = 0;
    let unanswered = 0;

    quizData.forEach((question, index) => {
        if (userAnswers[index] === null) {
            unanswered++;
        } else if (userAnswers[index] === question.correctAnswer) {
            correct++;
        } else {
            incorrect++;
        }
    });

    const totalQuestions = quizData.length;
    const totalScore = (correct * MARK_PER_MCQ) - (incorrect * NEGATIVE_MARKING);
    const totalMarks = totalQuestions * MARK_PER_MCQ;

    correctCountEl.textContent = correct;
    incorrectCountEl.textContent = incorrect;
    unansweredCountEl.textContent = unanswered;
    
    const performancePercentage = (correct / totalQuestions) * 100;
    performanceFillEl.style.width = `${performancePercentage}%`;

    const savedStudentData = JSON.parse(localStorage.getItem('studentData') || '{}');
    const lastAccessCode = localStorage.getItem('lastAccessCode') || 'N/A';
    
    let studentInfoHtml = '';
    for (const [key, value] of Object.entries(savedStudentData)) {
        studentInfoHtml += `<tr><td>${key}</td><td>${value}</td></tr>`;
    }
    studentInfoHtml += `<tr><td>Access Code Used</td><td>${lastAccessCode}</td></tr>`;
    studentInfoTable.innerHTML = studentInfoHtml;

    quizResultsTable.innerHTML = `
        <tr><td>Quiz ID</td><td>${currentQuizId}</td></tr>
        <tr><td>Total Questions</td><td>${totalQuestions}</td></tr>
        <tr><td>Correct Answers</td><td>${correct}</td></tr>
        <tr><td>Incorrect Answers</td><td>${incorrect}</td></tr>
        <tr><td>Unanswered</td><td>${unanswered}</td></tr>
        <tr><td>Your Score</td><td>${totalScore} / ${totalMarks}</td></tr>
    `;

    // --- NEW: SEND QUIZ RESULTS TO GOOGLE SHEET ---
    if (lastAccessCode && lastAccessCode !== 'N/A') {
        const resultsDataToSend = {
            type: 'quiz_result',
            accessCode: lastAccessCode,
            quizId: currentQuizId,
            totalQuestions: totalQuestions,
            correct: correct,
            incorrect: incorrect,
            unanswered: unanswered,
            totalScore: totalScore,
            totalMarks: totalMarks,
            studentName: savedStudentData['Student Name'] || 'Unknown' 
        };

        sendDataToSheet(resultsDataToSend)
            .then(response => {
                console.log('Sheet Results Update Response:', response);
            })
            .catch(error => {
                console.error('Sheet Results Update Error:', error);
                showQuizNotification('Submission Error', 'Failed to send results to the server sheet.', 'error');
            });
    }
    // ----------------------------------------------------


    const results = JSON.parse(localStorage.getItem('wcwQuizResults') || '[]');
    results.push({
        studentName: savedStudentData['Student Name'] || 'Unknown',
        accessCode: lastAccessCode,
        quizId: currentQuizId,
        totalQuestions: totalQuestions,
        correct: correct,
        incorrect: incorrect,
        unanswered: unanswered,
        totalScore: totalScore,
        totalMarks: totalMarks,
        timestamp: new Date().toISOString()
    });
    localStorage.setItem('wcwQuizResults', JSON.stringify(results));
    
    showQuizNotification('Quiz Completed!', `Your score: ${totalScore}/${totalMarks}. Check the results page for details.`, 'info');
    
    showPage('results-page');
}

function restartTest() {
    if (confirm('Are you sure you want to retake the full test? Your current progress will be lost.')) {
        quizData = quizData_WCW_CHE_007;
        currentQuestion = 0;
        userAnswers = Array(quizData.length).fill(null);
        timeLeft = quizData.length * TIME_PER_MCQ;
        
        showPage('quiz-page');
        initQuiz();
    }
}

function retakeIncorrect() {
    const incorrectIndices = quizData.map((question, index) => {
        const isIncorrect = userAnswers[index] !== null && 
                            userAnswers[index] !== question.correctAnswer;
        return isIncorrect ? index : -1;
    }).filter(index => index !== -1);
    
    if (incorrectIndices.length === 0) {
        showQuizNotification('No Incorrect Questions', 'You have no incorrect questions to retake!', 'info');
        return;
    }
    
    quizData = incorrectIndices.map(index => quizData_WCW_CHE_007[index]);
    currentQuestion = 0;
    userAnswers = Array(quizData.length).fill(null);
    timeLeft = quizData.length * TIME_PER_MCQ;
    
    showPage('quiz-page');
    initQuiz();
}

function viewAllMcqs() {
    allMcqsList.innerHTML = '';
    quizData_WCW_CHE_007.forEach((question, index) => {
        const mcqItem = document.createElement('div');
        mcqItem.classList.add('all-mcq-item');
        mcqItem.innerHTML = `
            <div class="question-text">${index + 1}. ${question.question}</div>
            <div class="all-mcq-options">
                ${question.options.map((option, optIndex) => `
                    <div class="all-mcq-option ${optIndex === question.correctAnswer ? 'correct' : ''}">
                        ${option}
                    </div>
                `).join('')}
            </div>
            <div class="all-mcq-reasoning">
                <strong>Reasoning:</strong> ${question.reasoning}
            </div>
        `;
        allMcqsList.appendChild(mcqItem);
    });
    showPage('all-mcqs-page');
}</script>